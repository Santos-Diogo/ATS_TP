<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>InputMapper.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">TP3_Projeto_ATS</a> &gt; <a href="index.source.html" class="el_package">com.marketplace.vintage.input</a> &gt; <span class="el_source">InputMapper.java</span></div><h1>InputMapper.java</h1><pre class="source lang-java linenums">package com.marketplace.vintage.input;

import com.marketplace.vintage.item.condition.ItemCondition;
import com.marketplace.vintage.item.condition.ItemConditions;
import com.marketplace.vintage.logging.Logger;
import com.marketplace.vintage.utils.StringUtils;

import java.math.BigDecimal;
import java.util.EnumSet;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.function.BiFunction;
import java.util.function.Function;
import java.util.stream.Collectors;

public final class InputMapper {

    private InputMapper() {
    }

<span class="fc" id="L22">    public static final Function&lt;String, String&gt; STRING = Function.identity();</span>

    public static Function&lt;String, Integer&gt; ofIntRange(int min, int max) {
<span class="fc" id="L25">        return (String input) -&gt; {</span>
            try {
<span class="fc" id="L27">                int value = Integer.parseInt(input);</span>
<span class="pc bpc" id="L28" title="2 of 4 branches missed.">                if (value &lt; min || value &gt; max) {</span>
<span class="nc" id="L29">                    throw new IllegalArgumentException(&quot;Value must be between &quot; + min + &quot; and &quot; + max);</span>
                }
<span class="fc" id="L31">                return value;</span>
<span class="nc" id="L32">            } catch (NumberFormatException e) {</span>
<span class="nc" id="L33">                throw new IllegalArgumentException(&quot;Value must be an integer&quot;);</span>
            }
        };
    }

<span class="fc" id="L38">    public static Function&lt;String, Boolean&gt; BOOLEAN = (String input) -&gt; {</span>
<span class="nc bnc" id="L39" title="All 2 branches missed.">        if (input.equalsIgnoreCase(&quot;y&quot;)) {</span>
<span class="nc" id="L40">            return true;</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">        } else if (input.equalsIgnoreCase(&quot;n&quot;)) {</span>
<span class="nc" id="L42">            return false;</span>
        } else {
<span class="nc" id="L44">            throw new IllegalArgumentException(&quot;Value must be 'y' or 'n'&quot;);</span>
        }
    };

<span class="fc" id="L48">    public static final Function&lt;String, BigDecimal&gt; BIG_DECIMAL = (String input) -&gt; {</span>
        try {
<span class="nc" id="L50">            return new BigDecimal(input);</span>
<span class="nc" id="L51">        } catch (NumberFormatException e) {</span>
<span class="nc" id="L52">            throw new IllegalArgumentException(&quot;Value must be a decimal number&quot;);</span>
        }
    };

    public static Function&lt;String, ItemCondition&gt; ofItemCondition(InputPrompter inputPrompter, Logger logger) {
<span class="nc" id="L57">        return (String input) -&gt; {</span>
<span class="nc bnc" id="L58" title="All 2 branches missed.">            if (input.equalsIgnoreCase(&quot;new&quot;)) {</span>
<span class="nc" id="L59">                return ItemConditions.NEW;</span>
<span class="nc bnc" id="L60" title="All 2 branches missed.">            } else if (input.equalsIgnoreCase(&quot;used&quot;)) {</span>
<span class="nc" id="L61">                int conditionLevel = inputPrompter.askForInput(logger, &quot;Insert the condition of the item (1/10, 1 being unusable, 10 perfect condition):&quot;, InputMapper.ofIntRange(1, 10));</span>
<span class="nc" id="L62">                int previousOwners = inputPrompter.askForInput(logger, &quot;Insert how many previous owners has the item had:&quot;, InputMapper.ofIntRange(0, Integer.MAX_VALUE));</span>
<span class="nc" id="L63">                return ItemConditions.createUsed(conditionLevel, previousOwners);</span>
            } else {
<span class="nc" id="L65">                throw new IllegalArgumentException(&quot;Value must be 'new' or 'used'&quot;);</span>
            }
        };
    }

    public static Function&lt;String, String&gt; ofExpression(BiFunction&lt;String, List&lt;String&gt;, Boolean&gt; expressionValidator, List&lt;String&gt; variables) {
<span class="nc" id="L71">        return (String input) -&gt; {</span>
            try {
<span class="nc" id="L73">                boolean isValid = expressionValidator.apply(input, variables);</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">                if (!isValid) {</span>
<span class="nc" id="L75">                    throw new IllegalArgumentException(&quot;Expression must be valid&quot;);</span>
                }
<span class="nc" id="L77">                return input;</span>
<span class="nc" id="L78">            } catch (Exception e) {</span>
<span class="nc" id="L79">                throw new IllegalArgumentException(e.getMessage());</span>
            }
        };
    }

    public static &lt;T&gt; Function&lt;String, T&gt; ofPossibleValues(Map&lt;String, T&gt; possibleValues) {
<span class="nc" id="L85">        return (String input) -&gt; {</span>
<span class="nc" id="L86">            Map&lt;String, T&gt; possibleValuesLowercase = new HashMap&lt;&gt;();</span>
<span class="nc bnc" id="L87" title="All 2 branches missed.">            for (String s : possibleValues.keySet()) {</span>
<span class="nc" id="L88">                String newKey = s.toLowerCase().replace('_', ' ');</span>
<span class="nc" id="L89">                possibleValuesLowercase.put(newKey, possibleValues.get(s));</span>
<span class="nc" id="L90">            }</span>

<span class="nc" id="L92">            T value = possibleValuesLowercase.get(input.toLowerCase());</span>
<span class="nc bnc" id="L93" title="All 2 branches missed.">            if (value == null) {</span>
<span class="nc" id="L94">                throw new IllegalArgumentException(&quot;Value must be one of &quot; + StringUtils.joinQuoted(possibleValuesLowercase.keySet(), &quot;, &quot;));</span>
            }
<span class="nc" id="L96">            return value;</span>
        };
    }

    public static &lt;T extends Enum&lt;T&gt;&gt; Function&lt;String, T&gt; ofEnumValues(Class&lt;T&gt; enumClass) {
<span class="nc" id="L101">        return ofPossibleValues(EnumSet.allOf(enumClass).stream().collect(Collectors.toMap(Enum::name, Function.identity())));</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>